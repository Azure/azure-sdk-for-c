stages:
  - stage: Build
    dependsOn: []
    # Purpose must be set at the level of the pipeline to enable this scenario
    condition: and(eq(variables['PipelineType'], 'unified'))
    jobs:
      - template: ../jobs/archetype-sdk-client.yml

  - ${{ if eq(variables['System.TeamProject'], 'internal') }}:
    - stage: LiveTest
      # Purpose must be set at the level of the pipeline to enable this scenario
      condition: and(eq(variables['PipelineType'], 'tests'))
      dependsOn: []
      jobs:
        - template: /eng/pipelines/templates/jobs/archetype-sdk-tests.yml
          parameters:
            LiveTestSamples:
              - Name: Storage Blobs
                LinuxMacPath: ./build/sdk/storage/blobs/samples/blobs_client_example
                WindowsPath: ./build/sdk/storage/blobs/samples/debug/blobs_client_example.exe

  - ${{ if and(ne(variables['Build.Reason'], 'PullRequest'), eq(variables['System.TeamProject'], 'internal')) }}:
    - template: archetype-c-release.yml
      parameters:
        DependsOn:
        - Build